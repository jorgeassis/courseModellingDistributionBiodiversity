% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dropLayers.R
\name{dropLayers}
\alias{dropLayers}
\title{Drop Raster Layers Based on Variance Threshold}
\usage{
dropLayers(rasters, threshold)
}
\arguments{
\item{rasters}{A terra \code{SpatRaster} object with one or more layers.}

\item{threshold}{Numeric. The minimum variance (exclusive) required for a layer
to be kept. Layers with variance less than or equal to this threshold,
or with undefined variance (e.g., fewer than 2 non-NA cells, constant values),
will be dropped.}
}
\value{
A \verb{terra SpatRaster} containing only the layers whose variance was
strictly greater than the threshold. If no layers meet the criteria,
an error might occur depending on subsequent usage (consider checking
\code{nlyr} of the result).
}
\description{
Removes layers from a SpatRaster object that have a variance of cell values
below (or equal to) a specified threshold. This is useful for removing constant
or near-constant predictor layers before modeling. Variance is calculated
across all non-NA cells for each layer.
}
\examples{
\dontrun{
library(terra)
# Create example rasters
r1 <- rast(nrows=10, ncols=10, vals=rnorm(100)) # Variable layer
r2 <- rast(nrows=10, ncols=10, vals=1)          # Constant layer
r3 <- rast(nrows=10, ncols=10, vals=runif(100)/100) # Low variance layer
r4 <- rast(nrows=10, ncols=10, vals=c(NA, 1:99)) # Layer with NAs
names(r1) <- "Variable"
names(r2) <- "Constant"
names(r3) <- "LowVariance"
names(r4) <- "WithNAs"

rasters_combined <- c(r1, r2, r3, r4)
print(rasters_combined)

# Calculate variances (using terra::global)
print(global(rasters_combined, fun="var", na.rm=TRUE))

# Drop layers with variance <= 0.01
rasters_filtered <- dropLayers(rasters_combined, threshold = 0.01)
print(rasters_filtered) # Should keep Variable and WithNAs

# Drop layers with variance <= 0
rasters_filtered_zero <- dropLayers(rasters_combined, threshold = 0)
print(rasters_filtered_zero) # Should keep Variable, LowVariance, WithNAs
}
}
